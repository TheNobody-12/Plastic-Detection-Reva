{% extends "base.html" %}
{% block body %}

<center>
    <h1 style="margin: 40px 0px;">Database Data Table</h1>
</center>
<div class="data" id="databaseTableDiv"></div>

<br><br>
<!-- give button to redirect to linechart -->
<center>
    <button type="button" class="btn btn-success"> <a href="/linecharts.html" style="color: rgb(255, 255, 255);"> Get
            Visualizations</a> </button>
</center>
<style>
    .data {
        display: flex;
        margin: 0px auto;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
    }

    th,
    td {
        padding: 10px;
        border-bottom: 1px solid #ddd;
        text-align: left;
    }

    th {
        background-color: #f2f2f2;
    }

    tr:hover {
        background-color: #f5f5f5;
    }
</style>

<script>
    // Fetch data from the Flask route
    fetch("/db_data")
        .then(response => response.json())
        .then(data => {
            console.log(data); // Check the data received from the Flask route

            // Create and populate the table dynamically
            const databaseTableDiv = document.getElementById("databaseTableDiv");
            const filenamesData = data.filenames;
            const latLonData = data.lat_lon;

            // Function to create the table row
            const createRow = (rowData) => {
                const row = document.createElement("tr");
                rowData.forEach((value) => {
                    const cell = document.createElement("td");
                    cell.textContent = value;
                    row.appendChild(cell);
                });
                return row;
            };

            // Create and populate the Filenames table
            const filenamesTable = document.createElement("table");
            filenamesTable.classList.add("table", "table-striped");
            const filenamesHeaderRow = createRow(["Unique Filename", "Number of Occurrences"]);
            filenamesHeaderRow.classList.add("table-header");
            filenamesTable.appendChild(filenamesHeaderRow);
            filenamesData.forEach((filenameData) => {
                const row = createRow([filenameData[0], filenameData[1]]);
                filenamesTable.appendChild(row);
            });
            databaseTableDiv.appendChild(filenamesTable);

            // Create and populate the Latitudes and Longitudes table
            const latLonTable = document.createElement("table");
            latLonTable.classList.add("table", "table-striped");
            const latLonHeaderRow = createRow(["Latitude", "Longitude"]);
            latLonHeaderRow.classList.add("table-header");
            latLonTable.appendChild(latLonHeaderRow);
            latLonData.forEach((latLonData) => {
                const row = createRow([latLonData[0], latLonData[1]]);
                latLonTable.appendChild(row);
            });
            databaseTableDiv.appendChild(latLonTable);
        })
        .catch(error => console.error("Error fetching database data:", error));
</script>

{% endblock body %}